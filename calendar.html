<!doctype html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AHS Class of ’28 — Calendar</title>
  <meta name="theme-color" content="#0d6efd" />
  <link rel="stylesheet" href="styles.css" />
  <style>
    /* Page-specific minor tweaks that build on styles.css */
    .calendar-header { display:flex; align-items:center; justify-content:space-between; gap:12px; margin: 18px 0 12px; }
    .calendar-header h2 { margin:0; font-size: clamp(20px, 3.2vw, 28px); font-weight: 900; letter-spacing:.2px; }
    .cal-controls { display:flex; align-items:center; gap:8px; }
    .cal-controls .btn { height:36px; padding:0 12px; }
    .legend { display:flex; flex-wrap:wrap; gap:8px; }
    .legend .badge { height:24px; font-size:11px; }
    .layout { display:grid; grid-template-columns: 2fr 1fr; gap:16px; }
    @media (max-width: 980px) { .layout { grid-template-columns: 1fr; } }

    /* Highlight selected event days */
    .cal-cell.event-day { position: relative; border-color: rgba(82,168,255,.4); }
    .cal-cell.event-day::after { content:""; position:absolute; inset:auto 6px 6px 6px; height:4px; border-radius:6px; background: linear-gradient(90deg,var(--blue),var(--blue-2)); opacity:.9; }

    /* Sidebar event list */
    .events-panel .card-item.active { outline:2px solid rgba(82,168,255,.55); }
    .events-panel .countdown-row { display:flex; align-items:center; gap:8px; flex-wrap:wrap; }
    .events-panel .countdown { display:flex; gap:8px; }
  </style>
</head>
<body>
  <!-- ===== Header / Navbar (exact structure) ===== -->
  <header class="header" role="banner">
    <nav class="nav" aria-label="Primary">
      <a class="brand" href="./" aria-label="AHS Class of 2028 — Home">
        <span class="logo" aria-hidden="true">A</span>
        AHS Class of ’28
      </a>

      <!-- Desktop links -->
      <div class="links" role="navigation">
        <a href="./index.html">Home</a>
        <a href="./fundraisers.html">Fundraisers</a>
        <a class="active" href="./calendar.html">Calendar</a>
        <a href="./media.html">Media</a>
        <a href="./achievements.html">Achievements</a>
        <a href="./about.html">About</a>
        <a href="./contact.html">Contact</a>
        <a href="./shop.html">Shop</a>
        <a href="./announcements.html">Announcements</a>
        <a href="./community.html">Community</a>
      </div>

      <!-- Mobile menu button -->
      <button id="menuBtn" class="menu-btn" aria-expanded="false"
              aria-controls="mobileMenu" aria-label="Open menu">☰</button>
    </nav>

    <!-- Mobile menu -->
    <div id="mobileMenu" class="mobile-menu hidden" role="dialog" aria-modal="true" aria-label="Mobile navigation">
      <a href="./index.html">Home</a>
      <a href="./fundraisers.html">Fundraisers</a>
      <a class="active" href="./calendar.html">Calendar</a>
      <a href="./media.html">Media</a>
      <a href="./achievements.html">Achievements</a>
      <a href="./about.html">About</a>
      <a href="./contact.html">Contact</a>
      <a href="./shop.html">Shop</a>
      <a href="./announcements.html">Announcements</a>
      <a href="./community.html">Community</a>
      <div class="small" style="padding:8px 10px; opacity:.8">Tap outside to close</div>
    </div>
  </header>

  <!-- ===== Page content ===== -->
  <main class="container" style="padding: 18px 0 40px;">
    <section class="section">
      <div class="section-title">2025–26 School Calendar (Worcester, MA)</div>
      <div class="section-sub">Key dates & school breaks. <span class="small">*Check official district updates for any changes.*</span></div>

      <div class="calendar-header">
        <div class="legend" aria-hidden="true">
          <span class="badge blue">School Break</span>
          <span class="badge success">Today</span>
        </div>
        <div class="cal-controls">
          <button id="prevBtn" class="btn" aria-label="Previous month">◀</button>
          <h2 id="monthLabel">Month YYYY</h2>
          <button id="nextBtn" class="btn" aria-label="Next month">▶</button>
          <button id="todayBtn" class="btn">Today</button>
        </div>
      </div>

      <div class="layout">
        <!-- Calendar grid -->
        <section class="panel glass" aria-label="Monthly calendar">
          <div class="grid" style="gap:8px; margin-bottom:6px; grid-template-columns:repeat(7,1fr);">
            <div class="small">Sun</div>
            <div class="small">Mon</div>
            <div class="small">Tue</div>
            <div class="small">Wed</div>
            <div class="small">Thu</div>
            <div class="small">Fri</div>
            <div class="small">Sat</div>
          </div>
          <div id="calendar" class="calendar" aria-live="polite"></div>
        </section>

        <!-- Events / countdowns -->
        <aside class="panel glass events-panel" aria-label="Upcoming breaks & events">
          <div class="section-title">Upcoming Events</div>
          <div id="eventsList" class="card-list"></div>
        </aside>
      </div>
    </section>
  </main>

  <footer class="footer">© <span id="year"></span> AHS Class of ’28 • Worcester, MA</footer>

  <script>
    // ===== Mobile menu logic =====
    (function mobileMenu(){
      const btn = document.getElementById('menuBtn');
      const menu = document.getElementById('mobileMenu');

      const closeMenu = () => {
        menu.classList.add('hidden');
        btn.setAttribute('aria-expanded','false');
        document.removeEventListener('click', onDocClick);
        document.removeEventListener('keydown', onKey);
      };
      const openMenu = () => {
        menu.classList.remove('hidden');
        btn.setAttribute('aria-expanded','true');
        setTimeout(()=>{
          document.addEventListener('click', onDocClick);
          document.addEventListener('keydown', onKey);
        },0);
      };
      const onDocClick = (e) => {
        if (!menu.contains(e.target) && e.target !== btn) closeMenu();
      };
      const onKey = (e) => { if (e.key === 'Escape') closeMenu(); };

      btn.addEventListener('click', () => {
        const open = btn.getAttribute('aria-expanded') === 'true';
        open ? closeMenu() : openMenu();
      });
    })();

    // ===== Calendar Data (2025–26) =====
    const events = [
      { id:'first-day', title:"First Day of School", start:"2025-08-27", end:"2025-08-27", kind:'milestone' },
      { id:'labor-day', title:"Labor Day – No School", start:"2025-09-01", end:"2025-09-01" },
      { id:'indigenous', title:"Indigenous Peoples’ Day – No School", start:"2025-10-13", end:"2025-10-13" },
      { id:'veterans', title:"Veterans Day – No School", start:"2025-11-11", end:"2025-11-11" },
      { id:'thanksgiving', title:"Thanksgiving Break", start:"2025-11-26", end:"2025-11-28" },
      { id:'winter', title:"Winter Break", start:"2025-12-24", end:"2026-01-01" },
      { id:'mlk', title:"MLK Jr. Day – No School", start:"2026-01-19", end:"2026-01-19" },
      { id:'feb-vac', title:"February Vacation", start:"2026-02-16", end:"2026-02-20" },
      { id:'apr-vac', title:"April Vacation (Patriots’ Day week)", start:"2026-04-20", end:"2026-04-24" },
      { id:'memorial', title:"Memorial Day – No School", start:"2026-05-25", end:"2026-05-25" },
    ];

    // Utility date helpers
    const toDate = (iso) => new Date(iso + 'T00:00:00');
    const formatRange = (s, e) => {
      const opts = { month:'short', day:'numeric', year:'numeric' };
      const sd = toDate(s); const ed = toDate(e);
      if (s === e) return sd.toLocaleDateString(undefined, opts);
      const sameMonth = sd.getMonth() === ed.getMonth() && sd.getFullYear() === ed.getFullYear();
      if (sameMonth) {
        return `${sd.toLocaleDateString(undefined,{ month:'short' })} ${sd.getDate()}–${ed.getDate()}, ${ed.getFullYear()}`;
      }
      return `${sd.toLocaleDateString(undefined, opts)} – ${ed.toLocaleDateString(undefined, opts)}`;
    };
    const withinRange = (d, s, e) => d >= s && d <= e;

    // Build calendar
    const calendarEl = document.getElementById('calendar');
    const monthLabel = document.getElementById('monthLabel');
    let view = (()=>{ const now=new Date(); return { y: now.getFullYear(), m: now.getMonth() }; })();

    function renderCalendar(y, m, highlightEventId=null){
      calendarEl.innerHTML = '';
      const first = new Date(y, m, 1);
      const startDay = first.getDay();
      const daysInMonth = new Date(y, m+1, 0).getDate();
      const today = new Date(); today.setHours(0,0,0,0);
      monthLabel.textContent = first.toLocaleDateString(undefined, { month:'long', year:'numeric' });

      // Leading blanks
      for (let i=0; i<startDay; i++) calendarEl.appendChild(document.createElement('div'));

      // Days
      for (let d=1; d<=daysInMonth; d++){
        const cell = document.createElement('div');
        cell.className = 'cal-cell';
        const date = new Date(y, m, d); date.setHours(0,0,0,0);

        // header day number
        const dayLbl = document.createElement('div');
        dayLbl.className = 'day';
        dayLbl.textContent = d;
        cell.appendChild(dayLbl);

        // mark today
        if (+date === +today) cell.classList.add('today');

        // event dots
        const dayISO = date.toISOString().slice(0,10);
        const has = events.filter(ev => withinRange(date, toDate(ev.start), toDate(ev.end)));
        if (has.length){
          const dot = document.createElement('div'); dot.className = 'dot';
          cell.appendChild(dot);
          cell.title = has.map(h=>h.title).join(' • ');
        }

        // highlight for selected event
        if (highlightEventId){
          const ev = events.find(e=>e.id===highlightEventId);
          if (ev) {
            const s = toDate(ev.start), e = toDate(ev.end);
            if (withinRange(date, s, e)) cell.classList.add('event-day');
          }
        }

        calendarEl.appendChild(cell);
      }
    }

    // Events list + countdowns
    const eventsListEl = document.getElementById('eventsList');
    function msUntil(date){ return +date - Date.now(); }
    function parts(ms){
      if (ms < 0) ms = 0;
      const sec = Math.floor(ms/1000);
      const days = Math.floor(sec/86400);
      const hours = Math.floor((sec%86400)/3600);
      const mins = Math.floor((sec%3600)/60);
      const s = sec%60;
      return {days,hours,mins,sec:s};
    }
    function fmtCountdown(ms){
      const {days,hours,mins} = parts(ms);
      return `${days}d ${hours}h ${mins}m`;
    }

    let activeEvent = null;
    function renderEvents(){
      eventsListEl.innerHTML = '';
      const nowISO = new Date().toISOString().slice(0,10);
      // sort by start date
      const sorted = [...events].sort((a,b)=> a.start.localeCompare(b.start));
      sorted.forEach(ev => {
        const item = document.createElement('div');
        item.className = 'card-item';
        item.setAttribute('role','button');
        item.tabIndex = 0;
        item.addEventListener('click', ()=> selectEvent(ev.id));
        item.addEventListener('keypress', (e)=>{ if(e.key==='Enter' || e.key===' ') selectEvent(ev.id); });

        if (activeEvent === ev.id) item.classList.add('active');

        const rowTop = document.createElement('div'); rowTop.className = 'row';
        const title = document.createElement('div'); title.className = 'title'; title.textContent = ev.title; rowTop.appendChild(title);
        const badge = document.createElement('span'); badge.className = 'badge blue'; badge.textContent = withinRange(toDate(nowISO), toDate(ev.start), toDate(ev.end)) ? 'Now' : 'Upcoming';
        rowTop.appendChild(badge);

        const meta = document.createElement('div'); meta.className = 'meta'; meta.textContent = formatRange(ev.start, ev.end);

        const rowBottom = document.createElement('div'); rowBottom.className = 'countdown-row';
        const cLabel = document.createElement('div'); cLabel.className = 'small'; cLabel.textContent = 'Starts in:';
        const cBadge = document.createElement('span'); cBadge.className = 'badge'; cBadge.style.fontWeight='800'; cBadge.id = `cd-${ev.id}`; cBadge.textContent = '—';
        rowBottom.appendChild(cLabel); rowBottom.appendChild(cBadge);

        item.appendChild(rowTop);
        item.appendChild(meta);
        item.appendChild(rowBottom);
        eventsListEl.appendChild(item);
      });
    }

    function tickCountdowns(){
      events.forEach(ev => {
        const el = document.getElementById(`cd-${ev.id}`);
        if (!el) return;
        const ms = msUntil(toDate(ev.start));
        el.textContent = fmtCountdown(ms);
        if (ms === 0) el.textContent = 'Today';
      });
    }

    function selectEvent(id){
      activeEvent = id;
      renderEvents();
      renderCalendar(view.y, view.m, id);
      // scroll to calendar on small screens
      if (window.innerWidth < 980) {
        document.getElementById('calendar').scrollIntoView({ behavior:'smooth', block:'start' });
      }
    }

    // Controls
    document.getElementById('prevBtn').addEventListener('click', ()=>{
      view.m--; if (view.m < 0){ view.m = 11; view.y--; }
      renderCalendar(view.y, view.m, activeEvent);
    });
    document.getElementById('nextBtn').addEventListener('click', ()=>{
      view.m++; if (view.m > 11){ view.m = 0; view.y++; }
      renderCalendar(view.y, view.m, activeEvent);
    });
    document.getElementById('todayBtn').addEventListener('click', ()=>{
      const now = new Date(); view.y = now.getFullYear(); view.m = now.getMonth();
      renderCalendar(view.y, view.m, activeEvent);
    });

    // Init
    (function init(){
      document.getElementById('year').textContent = new Date().getFullYear();
      renderEvents();
      renderCalendar(view.y, view.m);
      selectEvent('first-day'); // focus the first event by default
      tickCountdowns();
      setInterval(tickCountdowns, 1000 * 60); // update every minute
    })();
  </script>
</body>
</html>
