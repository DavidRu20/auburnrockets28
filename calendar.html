<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AHS Class of ’28 — Calendar</title>
  <meta name="theme-color" content="#0d6efd" />
  <link rel="stylesheet" href="styles.css?v=19" />
  <style>
    /* --- Page-specific styles (don’t force dark/light) --- */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: Arial, sans-serif; color: var(--text); background: transparent; overflow-x: hidden; line-height: 1.4; }

    /* Starfield canvas sits behind content */
    #starfield { position: fixed; inset: 0; z-index: -1; }

    /* Header tweaks (uses your global variables) */
    header.header { position: sticky; top: 0; z-index: 100; backdrop-filter: blur(6px); }
    :root[data-theme="dark"]  header.header { background: rgba(0,0,0,0.8); }
    :root[data-theme="light"] header.header { background: linear-gradient(180deg, rgba(255,255,255,.94), rgba(255,255,255,.86)); border-bottom: 1px solid var(--border); }

    /* Layout */
    main { display: flex; gap: 20px; padding: 20px; justify-content: center; flex-wrap: wrap; }

    /* Countdown list */
    .countdown-list { background: rgba(255,255,255,0.05); border-radius: 15px; padding: 20px; flex: 1 1 260px; max-width: 340px; }
    :root[data-theme="light"] .countdown-list { background: var(--panel); border: 1px solid var(--border); box-shadow: var(--shadow-1); }
    .countdown-item { margin-bottom: 12px; padding: 10px; border-radius: 10px; background: rgba(255,255,255,0.08); }
    :root[data-theme="light"] .countdown-item { background: rgba(0,0,0,.04); }

    /* Calendar */
    .calendar { background: rgba(255,255,255,0.05); border-radius: 20px; padding: 20px; flex: 1 1 700px; }
    :root[data-theme="light"] .calendar { background: var(--panel); border: 1px solid var(--border); box-shadow: var(--shadow-1); }
    .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
    .calendar-header button { background: #0d6efd; color: #fff; border: 0; padding: 8px 12px; border-radius: 8px; cursor: pointer; font-size: 1.1rem; }
    .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px; }
    .day-name { text-align: center; font-weight: 600; opacity: .85; }
    .day { background: rgba(255,255,255,0.08); border-radius: 12px; min-height: 90px; display: flex; flex-direction: column; padding: 8px; font-size: 1.05rem; transition: transform .2s ease, background .2s ease; }
    :root[data-theme="light"] .day { background: rgba(0,0,0,.04); }
    .day:hover { transform: scale(1.03); background: rgba(255,255,255,0.15); }
    :root[data-theme="light"] .day:hover { background: rgba(0,0,0,.08); }
    .day.today { background: #0d6efd; color: #fff; font-weight: bold; }
    .day.event { background: rgba(0,255,255,0.2); border: 1px solid cyan; }
    .day.break { background: rgba(255,165,0,0.2); border: 1px solid orange; }
    .event-label { font-size: .7em; margin-top: auto; opacity: .8; }
    .empty { background: transparent !important; border: 0; }
    /* === Calendar layout overrides (spread it out) === */
main{
  max-width: 1400px;   /* wider page */
  margin: 0 auto;
  padding: 24px;
  gap: 24px;
}

/* make the left sidebar a bit wider */
.countdown-list{
  flex: 0 0 340px;
  max-width: 360px;
}

/* bigger calendar cells + larger gaps */
.calendar{
  flex: 1 1 900px;
  padding: 24px;
  border-radius: 24px;
}
.calendar-grid{
  grid-template-columns: repeat(7, minmax(160px, 1fr));
  gap: 16px;
}
.day{
  min-height: 140px;
  border-radius: 16px;
  padding: 12px;
  font-size: 1.05rem;
}

/* nicer header spacing/buttons */
.calendar-header{
  margin-bottom: 18px;
}
.calendar-header button{
  padding: 10px 14px;
  font-size: 1.1rem;
  border-radius: 10px;
}

/* keep it comfortable on medium screens */
@media (max-width: 1200px){
  .calendar-grid{ grid-template-columns: repeat(7, minmax(130px, 1fr)); }
  .day{ min-height: 120px; }
}

/* phone sizing */
@media (max-width: 780px){
  main{ padding: 16px; gap: 16px; }
  .countdown-list{ flex: 1 1 100%; max-width: 100%; }
  .calendar{ flex: 1 1 100%; }
  .calendar-grid{ grid-template-columns: repeat(7, minmax(90px, 1fr)); gap: 8px; }
  .day{ min-height: 88px; padding: 8px; font-size: 1rem; }
}
  </style>
</head>
<body>
  <!-- Background -->
  <canvas id="starfield"></canvas>

  <!-- Header / Nav (only Calendar is active here) -->
  <header class="header" role="banner">
    <nav class="nav" aria-label="Primary">
      <a class="brand" href="./" aria-label="AHS Class of 2028 — Home">
        <span class="logo" aria-hidden="true">A</span> AHS Class of ’28
      </a>
      <div class="links" role="navigation">
        <a href="./">Home</a>
        <a href="./fundraisers.html">Fundraisers</a>
        <a class="active" href="./calendar.html">Calendar</a>
        <a href="./media.html">Media</a>
        <a href="./achievements.html">Achievements</a>
        <a href="./about.html">About</a>
        <a href="./contact.html">Contact</a>
        <a href="./merch.html">Shop</a>
        <a href="./community.html">Community</a>
      </div>
      <button id="menuBtn" class="menu-btn" aria-expanded="false" aria-controls="mobileMenu" aria-label="Open menu">☰</button>
    </nav>
    <div id="mobileMenu" class="mobile-menu hidden" role="dialog" aria-modal="true" aria-label="Mobile navigation">
      <a href="./">Home</a>
      <a href="./fundraisers.html">Fundraisers</a>
      <a class="active" href="./calendar.html">Calendar</a>
      <a href="./media.html">Media</a>
      <a href="./achievements.html">Achievements</a>
      <a href="./about.html">About</a>
      <a href="./contact.html">Contact</a>
      <a href="./merch.html">Shop</a>
      <a href="./community.html">Community</a>
      <div class="small" style="padding-top:8px;opacity:.8;">Tap outside to close</div>
    </div>
  </header>

  <!-- Main -->
  <main>
    <div class="countdown-list" id="holidayCountdowns"></div>

    <div class="calendar">
      <div class="calendar-header">
        <button id="prevMonth" type="button" aria-label="Previous month">‹</button>
        <h2 id="calendarMonth" aria-live="polite"></h2>
        <button id="nextMonth" type="button" aria-label="Next month">›</button>
      </div>

      <div class="calendar-grid" id="calendarGrid">
        <div class="day-name">Sun</div>
        <div class="day-name">Mon</div>
        <div class="day-name">Tue</div>
        <div class="day-name">Wed</div>
        <div class="day-name">Thu</div>
        <div class="day-name">Fri</div>
        <div class="day-name">Sat</div>
      </div>
    </div>
  </main>

  <!-- Scripts -->
  <script>
    /* ===== Mobile menu ===== */
    (function(){
      const btn = document.getElementById('menuBtn');
      const menu = document.getElementById('mobileMenu');
      if (!btn || !menu) return;
      btn.addEventListener('click', e=>{
        e.stopPropagation();
        const hidden = menu.classList.toggle('hidden');
        btn.setAttribute('aria-expanded', String(!hidden));
      });
      document.addEventListener('click', e=>{
        if (!menu.classList.contains('hidden') && !menu.contains(e.target) && e.target !== btn){
          btn.setAttribute('aria-expanded','false');
          menu.classList.add('hidden');
        }
      });
    })();

    /* ===== Starfield (theme-aware) ===== */
    (function(){
      const cvs = document.getElementById('starfield');
      const ctx = cvs.getContext('2d', { alpha: false });
      let stars = [];
      function resize(){
        cvs.width = innerWidth;
        cvs.height = innerHeight;
        stars = Array.from({length: 200}, ()=>({
          x: Math.random()*cvs.width,
          y: Math.random()*cvs.height,
          size: Math.random()*2,
          speed: Math.random()*0.3
        }));
      }
      addEventListener('resize', resize); resize();

      function draw(){
        const isLight = document.documentElement.getAttribute('data-theme') === 'light';
        const g = ctx.createLinearGradient(0,0,0,cvs.height);
        if (isLight){
          g.addColorStop(0,   '#eaf2ff');
          g.addColorStop(0.5, '#f7fbff');
          g.addColorStop(1,   '#ffffff');
        } else {
          g.addColorStop(0,   '#0b0e1a');
          g.addColorStop(1,   '#000000');
        }
        ctx.fillStyle = g;
        ctx.fillRect(0,0,cvs.width,cvs.height);

        ctx.fillStyle = isLight ? 'rgba(60,90,140,0.8)' : 'rgba(180,200,255,0.8)';
        stars.forEach(s=>{
          ctx.beginPath();
          ctx.arc(s.x, s.y, s.size, 0, Math.PI*2);
          ctx.fill();
          s.y += s.speed;
          if (s.y > cvs.height){ s.y = 0; s.x = Math.random()*cvs.width; }
        });

        requestAnimationFrame(draw);
      }
      draw();
    })();

    /* ===== Events (sample) ===== */
    const events = {
      "2025-08-27": { type: "event", label: "First Day of School" },
      "2025-09-01": { type: "break", label: "Labor Day" },
      "2025-11-11": { type: "break", label: "Veterans Day" },
      "2025-11-26": { type: "break", label: "Thanksgiving Break" },
      "2025-11-27": { type: "break", label: "Thanksgiving Break" },
      "2025-11-28": { type: "break", label: "Thanksgiving Break" },
      "2025-12-22": { type: "break", label: "Winter Break" },
      "2025-12-23": { type: "break", label: "Winter Break" },
      "2025-12-24": { type: "break", label: "Winter Break" },
      "2025-12-25": { type: "break", label: "Winter Break" },
      "2025-12-26": { type: "break", label: "Winter Break" },
      "2025-12-29": { type: "break", label: "Winter Break" },
      "2025-12-30": { type: "break", label: "Winter Break" },
      "2025-12-31": { type: "break", label: "Winter Break" },
      "2026-01-01": { type: "break", label: "Winter Break" },
      "2026-01-19": { type: "break", label: "MLK Day" },
      "2026-02-16": { type: "break", label: "Presidents Day" },
      "2026-04-13": { type: "break", label: "Spring Break" },
      "2026-04-14": { type: "break", label: "Spring Break" },
      "2026-04-15": { type: "break", label: "Spring Break" },
      "2026-04-16": { type: "break", label: "Spring Break" },
      "2026-04-17": { type: "break", label: "Spring Break" },
      "2026-06-12": { type: "event", label: "Last Day of School" }
    };

    /* ===== Calendar render ===== */
    (function(){
      const grid = document.getElementById("calendarGrid");
      const monthLabel = document.getElementById("calendarMonth");
      const prevBtn = document.getElementById("prevMonth");
      const nextBtn = document.getElementById("nextMonth");
      let current = new Date();

      function renderCalendar(date){
        const y = date.getFullYear();
        const m = date.getMonth();
        monthLabel.textContent = date.toLocaleString("default", { month: "long", year: "numeric" });

        // remove previous days
        grid.querySelectorAll(".day:not(.day-name)").forEach(el => el.remove());

        const first = new Date(y, m, 1);
        const last  = new Date(y, m+1, 0);
        const startDay = first.getDay();
        const total = last.getDate();

        for (let i=0; i<startDay; i++){
          const empty = document.createElement("div");
          empty.className = "day empty";
          grid.appendChild(empty);
        }

        const today = new Date(); today.setHours(0,0,0,0);

        for (let d=1; d<=total; d++){
          const cell = document.createElement("div");
          cell.className = "day";
          cell.textContent = d;

          const key = `${y}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
          if (events[key]) {
            cell.classList.add(events[key].type);
            const lbl = document.createElement("div");
            lbl.className = "event-label";
            lbl.textContent = events[key].label;
            cell.appendChild(lbl);
          }

          const thisDay = new Date(y, m, d); thisDay.setHours(0,0,0,0);
          if (+thisDay === +today) cell.classList.add("today");

          grid.appendChild(cell);
        }
      }

      prevBtn.addEventListener("click", ()=>{ current.setMonth(current.getMonth()-1); renderCalendar(current); });
      nextBtn.addEventListener("click", ()=>{ current.setMonth(current.getMonth()+1); renderCalendar(current); });
      renderCalendar(current);
    })();

    /* ===== Upcoming holidays countdown ===== */
    (function(){
      const wrap = document.getElementById("holidayCountdowns");
      function update(){
        wrap.innerHTML = "<h2 style='margin-bottom:10px;'>Upcoming Holidays</h2>";
        const now = new Date();
        Object.keys(events)
          .map(d => ({ date: new Date(d), ...events[d] }))
          .filter(e => e.date >= now)
          .sort((a,b) => a.date - b.date)
          .slice(0, 8)
          .forEach(e => {
            const diff = e.date - now;
            const days = Math.floor(diff / (1000*60*60*24));
            const hours = Math.floor((diff % (1000*60*60*24)) / (1000*60*60));
            const item = document.createElement("div");
            item.className = "countdown-item";
            item.innerHTML = `<h3>${e.label}</h3><p>${days} days, ${hours} hours</p>`;
            wrap.appendChild(item);
          });
      }
      update();
      setInterval(update, 60*1000); // refresh every minute
    })();
  </script>

  <!-- Global site script (theme toggle, transitions, etc.) -->
  <script src="script.js?v=19"></script>
</body>
</html>
